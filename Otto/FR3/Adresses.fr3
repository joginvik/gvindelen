<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.9.64" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.AllowEdit="False" PreviewOptions.Buttons="4095" PreviewOptions.ShowCaptions="True" PreviewOptions.Zoom="1" PreviewOptions.ZoomMode="zmManyPages" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="41486,8870889236" ReportOptions.Description.Text="" ReportOptions.LastChange="41487,0600658565" ScriptLanguage="PascalScript" ScriptText.Text="procedure btnOkOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if lcbCity.KeyValue = null then                                                                               &#13;&#10;    set('place_id', '');                                                            &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403180103546F7003380108446174617365747301010C3000000020446174615365743D2271727941647265737365732220446174615365744E616D653D2271727941647265737365732200010C2C00000020446174615365743D227172794369746965732220446174615365744E616D653D227172794369746965732200010C2A00000020446174615365743D2271727941726561732220446174615365744E616D653D2271727941726561732200010C2E00000020446174615365743D22717279526567696F6E732220446174615365744E616D653D22717279526567696F6E732200010C3200000020446174615365743D22717279506C616365546578742220446174615365744E616D653D22717279506C61636554657874220000095661726961626C657301010C16000000204E616D653D22204E65772043617465676F7279312200010C11000000204E616D653D22726567696F6E5F69642200010C0F000000204E616D653D22617265615F69642200010C10000000204E616D653D22706C6163655F6964220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxFIBQuery Name="qryAdresses" UserName="qryAdresses" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select *&#13;&#10;from (select max(a.adress_id) adress_id, a.place_id, a.adress_text, max(a.client_id) client_id, max(a.postindex) postindex, count(o.order_id) order_count&#13;&#10;from v_adress_text a&#13;&#10;  inner join orders o on (o.adress_id = a.adress_id)&#13;&#10;where o.create_dtm between :from_date and :to_date&#13;&#10;group by a.place_id, a.adress_text) a&#13;&#10;  inner join v_places p on (p.place_id = a.place_id)&#13;&#10;  inner join v_clients_fio cl on (cl.client_id = a.client_id)&#13;&#10;where a.order_count &#62;= :order_count&#13;&#10;--  and p.place_id = coalesce(:place_id, p.place_id)&#13;&#10;--  and p.region_id = coalesce(:region_id, p.region_id)&#13;&#10;--  and p.area_id = coalesce(:area_id, p.area_id)&#13;&#10;order by p.region_name, p.area_name, p.place_name, cl.client_fio, a.adress_text                                                                                             &#13;&#10;  " PropData="05704C65667402600470546F70022C0A506172616D657465727301010C3C000000204E616D653D2266726F6D5F64617465222044617461547970653D22667444617465222045787072657373696F6E3D22646546726F6D2E446174652200010C38000000204E616D653D22746F5F64617465222044617461547970653D22667444617465222045787072657373696F6E3D226465546F2E446174652200010C46000000204E616D653D226F726465725F636F756E74222044617461547970653D226674496E7465676572222045787072657373696F6E3D22654F72646572436F756E742E546578742200010C43000000204E616D653D22706C6163655F6964222044617461547970653D226674496E7465676572222045787072657373696F6E3D226C6362436974792E4B657956616C75652200010C46000000204E616D653D22726567696F6E5F6964222044617461547970653D226674496E7465676572222045787072657373696F6E3D226C6362526567696F6E2E4B657956616C75652200010C42000000204E616D653D22617265615F6964222044617461547970653D226674496E7465676572222045787072657373696F6E3D226C6362417265612E4B657956616C7565220000"/>
    <TfrxFIBQuery Name="qryCities" UserName="qryCities" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select p.place_id, p.place_name                                                  &#13;&#10;from places p&#13;&#10;where p.placetype_code in (4,5)      &#13;&#10;order by p.place_name                                              &#13;&#10;                                                                                                                                              " PropData="05704C65667403B8000470546F70022C0A506172616D65746572730100"/>
    <TfrxFIBQuery Name="qryAreas" UserName="qryAreas" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="qryRegions" IgnoreDupParams="False" SQL.Text="select p.place_id area_id, place_name                                                                           &#13;&#10;from places p&#13;&#10;where p.placetype_code = 3&#13;&#10;--  and p.owner_place = :region_id&#13;&#10;order by place_name                                                    " PropData="05704C6566740310010470546F70022C0A506172616D657465727301010C5C000000204E616D653D22726567696F6E5F6964222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B717279526567696F6E732E262333343B524547494F4E5F4944262333343B262336323B220000"/>
    <TfrxFIBQuery Name="qryRegions" UserName="qryRegions" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select p.place_id region_id, place_name                                                                        &#13;&#10;from places p&#13;&#10;where p.placetype_code = 2  " PropData="05704C656674036C010470546F70022C0A506172616D65746572730100"/>
    <TfrxFIBQuery Name="qryPlaceText" UserName="qryPlaceText" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="qryAdresses" IgnoreDupParams="False" SQL.Text="select *&#13;&#10;from v_place_text pt       &#13;&#10;where pt.place_id = :place_id                                                                        " PropData="05704C65667403D8010470546F70022C0A506172616D657465727301010C25000000204E616D653D22706C6163655F6964222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" Height="22,67718" Left="0" Top="16" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="qryAdresses" DataSetName="qryAdresses" RowCount="0" Stretched="True">
      <TfrxMemoView Name="qryAdressesCLIENT_FIO" Left="0" Top="0" Width="264,5671" Height="18,89765" ShowHint="False" DataField="CLIENT_FIO" DataSet="qryAdresses" DataSetName="qryAdresses" Text="[qryAdresses.&#34;CLIENT_FIO&#34;]"/>
      <TfrxMemoView Name="qryAdressesADRESS_TEXT" Left="264,5671" Top="0" Width="340,1577" Height="18,89765" ShowHint="False" DataField="ADRESS_TEXT" DataSet="qryAdresses" DataSetName="qryAdresses" Text="[qryAdresses.&#34;ADRESS_TEXT&#34;]"/>
      <TfrxMemoView Name="qryAdressesPOSTINDEX" Left="944,8825" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" DataField="POSTINDEX" DataSet="qryAdresses" DataSetName="qryAdresses" Text="[qryAdresses.&#34;POSTINDEX&#34;]"/>
      <TfrxMemoView Name="qryPlaceTextPLACE_TEXT" Left="604,7248" Top="0" Width="340,1577" Height="18,89765" ShowHint="False" DataField="PLACE_TEXT" DataSet="qryPlaceText" DataSetName="qryPlaceText" Text="[qryPlaceText.&#34;PLACE_TEXT&#34;]"/>
    </TfrxMasterData>
  </TfrxReportPage>
  <TfrxDialogPage Name="dlgCriterias" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Заявки созданные" Height="283" ClientHeight="245" Left="265" Top="150" Width="377" ClientWidth="361">
    <TfrxGroupBoxControl Name="GroupBox1" Left="8" Top="8" Width="345" Height="65" ShowHint="True" Caption="Заявки созданные" Color="-16777201">
      <TfrxDateEditControl Name="deFrom" Left="32" Top="24" Width="85" Height="21" ShowHint="True" Color="-16777211" Date="41306,9320437732" Time="41306,9320437732"/>
      <TfrxDateEditControl Name="deTo" Left="148" Top="24" Width="85" Height="21" ShowHint="True" Color="-16777211" Date="41486,9321483102" Time="41486,9321483102"/>
      <TfrxLabelControl Name="Label1" Left="20" Top="28" Width="7" Height="13" ShowHint="True" AutoSize="False" Caption="C" Color="-16777201"/>
      <TfrxLabelControl Name="Label2" Left="128" Top="28" Width="12" Height="13" ShowHint="True" Caption="по" Color="-16777201"/>
      <TfrxEditControl Name="eOrderCount" Left="296" Top="24" Width="33" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="1"/>
      <TfrxLabelControl Name="Label3" Left="252" Top="28" Width="35" Height="13" ShowHint="True" Caption="Кол-во" Color="-16777201"/>
    </TfrxGroupBoxControl>
    <TfrxGroupBoxControl Name="GroupBox2" Left="8" Top="76" Width="217" Height="153" ShowHint="True" Visible="False" Caption="Место проживания заказчика" Color="-16777201">
      <TfrxDBLookupComboBox Name="lcbArea" Left="12" Top="72" Width="193" Height="21" Enabled="False" ShowHint="True" AutoOpenDataSet="True" ListField="PLACE_NAME" DataSet="qryAreas" DataSetName="qryAreas" KeyField="AREA_ID" DropDownWidth="0" DropDownRows="7"/>
      <TfrxDBLookupComboBox Name="lcbRegion" Left="12" Top="32" Width="193" Height="21" Enabled="False" ShowHint="True" AutoOpenDataSet="True" ListField="PLACE_NAME" DataSet="qryRegions" DataSetName="qryRegions" KeyField="REGION_ID" DropDownWidth="0" DropDownRows="10"/>
      <TfrxLabelControl Name="Label4" Left="12" Top="16" Width="43" Height="13" ShowHint="True" Caption="Область" Color="-16777201"/>
      <TfrxLabelControl Name="Label5" Left="12" Top="56" Width="30" Height="13" ShowHint="True" Caption="Район" Color="-16777201"/>
      <TfrxLabelControl Name="Label6" Left="12" Top="96" Width="31" Height="13" ShowHint="True" Caption="Город" Color="-16777201"/>
      <TfrxDBLookupComboBox Name="lcbCity" Left="12" Top="112" Width="193" Height="21" ShowHint="True" AutoOpenDataSet="True" ListField="PLACE_NAME" DataSet="qryCities" DataSetName="qryCities" KeyField="PLACE_ID" DropDownWidth="0" DropDownRows="7"/>
    </TfrxGroupBoxControl>
    <TfrxButtonControl Name="btnCancel" Left="276" Top="164" Width="75" Height="25" ShowHint="True" Cancel="True" Caption="Отмена" ModalResult="2"/>
    <TfrxButtonControl Name="btnOk" Left="276" Top="112" Width="75" Height="25" ShowHint="True" Caption="Получить" ModalResult="1" OnClick="btnOkOnClick"/>
  </TfrxDialogPage>
</TfrxReport>
