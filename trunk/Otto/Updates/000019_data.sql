SET SQL DIALECT 3;

SET NAMES WIN1251;

SET CLIENTLIB 'fbclient.dll';


UPDATE ACTIONCODES
SET PROCEDURE_NAME = NULL
WHERE (ACTION_SIGN = 'ACCOUNT_CREDIT');

INSERT INTO ACTIONCODES (ACTION_SIGN, ACTION_NAME, OBJECT_SIGN, PROCEDURE_NAME)
  VALUES ('ACCOUNT_CREDITORDER', 'Списание средств на заявку', 'ACCOUNT', NULL);

UPDATE ACTIONCODES
SET PROCEDURE_NAME = NULL
WHERE (ACTION_SIGN = 'ACCOUNT_DEBIT');

INSERT INTO ACTIONCODES (ACTION_SIGN, ACTION_NAME, OBJECT_SIGN, PROCEDURE_NAME)
  VALUES ('ACCOUNT_DEBITORDER', 'Перевод средств с заявки', 'ACCOUNT', NULL);

INSERT INTO ACTIONCODES (ACTION_SIGN, ACTION_NAME, OBJECT_SIGN, PROCEDURE_NAME)
  VALUES ('ACCOUNT_MANUALCREDIT', 'Ручное списание со счета ', 'ACCOUNT', 'ACCOUNT_CREDIT');

INSERT INTO ACTIONCODES (ACTION_SIGN, ACTION_NAME, OBJECT_SIGN, PROCEDURE_NAME)
  VALUES ('ACCOUNT_MANUALDEBIT', 'Ручное зачисление на счет', 'ACCOUNT', 'ACCOUNT_DEBIT');

INSERT INTO ACTIONCODES (ACTION_SIGN, ACTION_NAME, OBJECT_SIGN, PROCEDURE_NAME)
  VALUES ('ACCOUNT_PAYMENTIN', 'Входящий платеж', 'ACCOUNT', NULL);

INSERT INTO ACTIONCODES (ACTION_SIGN, ACTION_NAME, OBJECT_SIGN, PROCEDURE_NAME)
  VALUES ('PLACE_CREATE', 'Зарегистрирвать населенный пункт', 'PLACE', 'PLACE_STORE');



INSERT INTO ACTIONCODE_CRITERIAS (ACTIONCODE_SIGN, PARAM_NAME, PARAM_KIND, PARAM_ACTION, PARAM_VALUE_1, PARAM_VALUE_2)
  VALUES ('ACCOUNT_MANUALCREDIT', 'AMOUNT_EUR', 'N', '>', '0', NULL);

INSERT INTO ACTIONCODE_CRITERIAS (ACTIONCODE_SIGN, PARAM_NAME, PARAM_KIND, PARAM_ACTION, PARAM_VALUE_1, PARAM_VALUE_2)
  VALUES ('ACCOUNT_MANUALDEBIT', 'AMOUNT_EUR', 'N', '>=', '0', NULL);



INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_CREDITORDER', 'AMOUNT_EUR', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_CREDITORDER', 'ID', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_CREDITORDER', 'NOTES', 'V', 'Списание средств на заявку');

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_CREDITORDER', 'ORDER_ID', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_DEBITORDER', 'AMOUNT_EUR', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_DEBITORDER', 'ID', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_DEBITORDER', 'NOTES', 'V', 'Зачисление средств с заявки');

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_DEBITORDER', 'ORDER_ID', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_MANUALCREDIT', 'AMOUNT_EUR', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_MANUALCREDIT', 'BYR2EUR', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_MANUALCREDIT', 'ID', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_MANUALCREDIT', 'NOTES', 'V', 'Ручное списание cуммы [AMOUNT_EUR] EUR со счета по курсу [BYR2EUR]');

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_MANUALDEBIT', 'AMOUNT_EUR', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_MANUALDEBIT', 'BYR2EUR', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_MANUALDEBIT', 'ID', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_MANUALDEBIT', 'NOTES', 'V', 'Ручное зачисление cуммы [AMOUNT_EUR] EUR на счет по курсу [BYR2EUR]');

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_PAYMENTIN', 'AMOUNT_BYR', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_PAYMENTIN', 'ID', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_PAYMENTIN', 'NOTES', 'V', 'Зачиление платежа [AMOUNT_BYR] BYR по заявке [ORDER_CODE] на сумму [AMOUNT_EUR] по курсу [BYR2EUR]');

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('ACCOUNT_PAYMENTIN', 'ORDER_ID', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('PAYMENT_ASSIGN', 'ORDER_ID', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('PLACE_CREATE', 'AREA_ID', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('PLACE_CREATE', 'PLACETYPE_CODE', 'I', NULL);

INSERT INTO ACTIONCODE_PARAMS (ACTION_SIGN, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES ('PLACE_CREATE', 'PLACE_NAME', 'I', NULL);



INSERT INTO ACTIONTREE (ACTIONTREEITEM_ID, ACTION_SIGN, ORDER_NO, CHILD_ACTION)
  VALUES (30, 'ACCOUNT_PAYMENTIN', 1, 'ACCOUNT_CREDITORDER');



INSERT INTO ACTIONTREE_PARAMS (ACTIONTREEITEM_ID, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES (30, 'AMOUNT_EUR', 'A', 'AMOUNT_EUR');

INSERT INTO ACTIONTREE_PARAMS (ACTIONTREEITEM_ID, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES (30, 'BYR2EUR', 'A', 'BYR2EUR');

INSERT INTO ACTIONTREE_PARAMS (ACTIONTREEITEM_ID, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES (30, 'ID', 'A', 'ID');

INSERT INTO ACTIONTREE_PARAMS (ACTIONTREEITEM_ID, PARAM_NAME, PARAM_KIND, PARAM_VALUE)
  VALUES (30, 'ORDER_ID', 'A', 'ORDER_ID');



INSERT INTO ATTRS (ATTR_ID, OBJECT_SIGN, ATTR_SIGN, ATTR_NAME, FIELD_NAME, DIRECTION)
  VALUES (732, 'ORDER', 'ACCOUNT_ID', 'Id счета', 'ACCOUNT_ID', NULL);

INSERT INTO ATTRS (ATTR_ID, OBJECT_SIGN, ATTR_SIGN, ATTR_NAME, FIELD_NAME, DIRECTION)
  VALUES (733, 'ORDER', 'AUFTRAG_ID', 'Id заказа в отто', NULL, NULL);



UPDATE STATUSES
SET FLAG_SIGN_LIST = NULL
WHERE (STATUS_ID = 163);

UPDATE STATUSES
SET FLAG_SIGN_LIST = NULL
WHERE (STATUS_ID = 169);

UPDATE STATUSES
SET FLAG_SIGN_LIST = ',DELETEABLE,DRAFT,ERROR,'
WHERE (STATUS_ID = 172);

UPDATE STATUSES
SET FLAG_SIGN_LIST = NULL
WHERE (STATUS_ID = 173);

UPDATE STATUSES
SET FLAG_SIGN_LIST = NULL
WHERE (STATUS_ID = 178);

UPDATE STATUSES
SET FLAG_SIGN_LIST = NULL
WHERE (STATUS_ID = 179);

UPDATE STATUSES
SET FLAG_SIGN_LIST = NULL
WHERE (STATUS_ID = 181);

UPDATE STATUSES
SET FLAG_SIGN_LIST = NULL
WHERE (STATUS_ID = 183);

UPDATE STATUSES
SET FLAG_SIGN_LIST = ',DELETEABLE,DRAFT,ERROR,'
WHERE (STATUS_ID = 188);





UPDATE STATUS_RULES
SET ACTION_SIGN = 'ORDERITEM_REJECT'
WHERE (OLD_STATUS_ID = 175) AND (NEW_STATUS_ID = 178);

UPDATE STATUS_RULES
SET ACTION_SIGN = 'ORDERITEM_ACCEPT'
WHERE (OLD_STATUS_ID = 175) AND (NEW_STATUS_ID = 180);



DELETE FROM STATUS_RULES
WHERE (OLD_STATUS_ID = 231) AND (NEW_STATUS_ID = 232);
DELETE FROM STATUS_RULES
WHERE (OLD_STATUS_ID = 231) AND (NEW_STATUS_ID = 239);
DELETE FROM STATUS_RULES
WHERE (OLD_STATUS_ID = 232) AND (NEW_STATUS_ID = 235);
DELETE FROM STATUS_RULES
WHERE (OLD_STATUS_ID = 235) AND (NEW_STATUS_ID = 236);


DELETE FROM FLAGS2STATUSES
WHERE (STATUS_ID = 169) AND (FLAG_SIGN = 'DEBIT');
DELETE FROM FLAGS2STATUSES
WHERE (STATUS_ID = 172) AND (FLAG_SIGN = 'DEBIT');
DELETE FROM FLAGS2STATUSES
WHERE (STATUS_ID = 173) AND (FLAG_SIGN = 'DEBIT');
DELETE FROM FLAGS2STATUSES
WHERE (STATUS_ID = 188) AND (FLAG_SIGN = 'DEBIT');


DELETE FROM ATTRS
WHERE (ATTR_ID = 808);
DELETE FROM ATTRS
WHERE (ATTR_ID = 809);
DELETE FROM ATTRS
WHERE (ATTR_ID = 919);
DELETE FROM ATTRS
WHERE (ATTR_ID = 933);
DELETE FROM ATTRS
WHERE (ATTR_ID = 1803);


DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 1) AND (PARAM_NAME = 'ID') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 1) AND (PARAM_NAME = 'REST_EUR') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 41) AND (PARAM_NAME = 'ACCOUNT_ID') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 41) AND (PARAM_NAME = 'AMOUNT_EUR') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 41) AND (PARAM_NAME = 'BYR2EUR') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 41) AND (PARAM_NAME = 'ID') AND (PARAM_KIND = 'O');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 41) AND (PARAM_NAME = 'ORDER_ID') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 42) AND (PARAM_NAME = 'INVOICE_ID') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 42) AND (PARAM_NAME = 'NEW.ACTION_SIGN') AND (PARAM_KIND = 'V');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 42) AND (PARAM_NAME = 'ORDER_ID') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 43) AND (PARAM_NAME = 'ACTION_SIGN') AND (PARAM_KIND = 'V');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 43) AND (PARAM_NAME = 'INVOICE_ID') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 43) AND (PARAM_NAME = 'ORDER_ID') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 51) AND (PARAM_NAME = 'ID') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 52) AND (PARAM_NAME = 'AMOUNT_EUR') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 52) AND (PARAM_NAME = 'ID') AND (PARAM_KIND = 'A');
DELETE FROM ACTIONTREE_PARAMS
WHERE (ACTIONTREEITEM_ID = 53) AND (PARAM_NAME = 'ID') AND (PARAM_KIND = 'A');


DELETE FROM ACTIONTREE
WHERE (ACTIONTREEITEM_ID = 1);
DELETE FROM ACTIONTREE
WHERE (ACTIONTREEITEM_ID = 41);
DELETE FROM ACTIONTREE
WHERE (ACTIONTREEITEM_ID = 42);
DELETE FROM ACTIONTREE
WHERE (ACTIONTREEITEM_ID = 43);
DELETE FROM ACTIONTREE
WHERE (ACTIONTREEITEM_ID = 51);
DELETE FROM ACTIONTREE
WHERE (ACTIONTREEITEM_ID = 52);
DELETE FROM ACTIONTREE
WHERE (ACTIONTREEITEM_ID = 53);


DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ACCOUNT_USERCREDIT') AND (PARAM_NAME = 'AMOUNT_EUR') AND (PARAM_KIND = 'I');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ACCOUNT_USERCREDIT') AND (PARAM_NAME = 'AMOUNT_EUR') AND (PARAM_KIND = 'W');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ACCOUNT_USERCREDIT') AND (PARAM_NAME = 'BALANCE_EUR') AND (PARAM_KIND = 'W');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ACCOUNT_USERCREDIT') AND (PARAM_NAME = 'ID') AND (PARAM_KIND = 'I');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ACCOUNT_USERCREDIT') AND (PARAM_NAME = 'REST_EUR') AND (PARAM_KIND = 'W');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ACCOUNT_USERCREDIT') AND (PARAM_NAME = 'SIGN') AND (PARAM_KIND = 'V');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ACCOUNT_USERDEBIT') AND (PARAM_NAME = 'AMOUNT_EUR') AND (PARAM_KIND = 'I');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ACCOUNT_USERDEBIT') AND (PARAM_NAME = 'AMOUNT_EUR') AND (PARAM_KIND = 'W');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ACCOUNT_USERDEBIT') AND (PARAM_NAME = 'BALANCE_EUR') AND (PARAM_KIND = 'W');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ACCOUNT_USERDEBIT') AND (PARAM_NAME = 'ID') AND (PARAM_KIND = 'I');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ACCOUNT_USERDEBIT') AND (PARAM_NAME = 'REST_EUR') AND (PARAM_KIND = 'W');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ACCOUNT_USERDEBIT') AND (PARAM_NAME = 'SIGN') AND (PARAM_KIND = 'V');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'INVOICE_CANCEL') AND (PARAM_NAME = 'ID') AND (PARAM_KIND = 'I');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'INVOICE_CANCEL') AND (PARAM_NAME = 'NEW.STATUS_SIGN') AND (PARAM_KIND = 'V');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ORDERITEM_INVOICE') AND (PARAM_NAME = 'ID') AND (PARAM_KIND = 'I');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ORDERITEM_INVOICE') AND (PARAM_NAME = 'INVOICE_ID') AND (PARAM_KIND = 'I');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ORDERTAX_INVOICE') AND (PARAM_NAME = 'ID') AND (PARAM_KIND = 'I');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'ORDERTAX_INVOICE') AND (PARAM_NAME = 'INVOICE_ID') AND (PARAM_KIND = 'I');
DELETE FROM ACTIONCODE_PARAMS
WHERE (ACTION_SIGN = 'PAYMENT_ASSIGN') AND (PARAM_NAME = 'INVOICE_ID') AND (PARAM_KIND = 'I');


DELETE FROM ACTIONCODE_CRITERIAS
WHERE (ACTIONCODE_SIGN = 'ACCOUNT_USERCREDIT') AND (PARAM_NAME = 'AMOUNT_EUR');
DELETE FROM ACTIONCODE_CRITERIAS
WHERE (ACTIONCODE_SIGN = 'ACCOUNT_USERDEBIT') AND (PARAM_NAME = 'AMOUNT_EUR');
DELETE FROM ACTIONCODE_CRITERIAS
WHERE (ACTIONCODE_SIGN = 'ORDERITEM_INVOICE') AND (PARAM_NAME = 'INVOICE_DTM.NEW');
DELETE FROM ACTIONCODE_CRITERIAS
WHERE (ACTIONCODE_SIGN = 'ORDERTAX_INVOICE') AND (PARAM_NAME = 'INVOICE_DTM.NEW');


DELETE FROM ACTIONS
WHERE (ACTION_SIGN = 'ACCOUNT_USERCREDIT');
DELETE FROM ACTIONS
WHERE (ACTION_SIGN = 'ACCOUNT_USERDEBIT');
DELETE FROM ACTIONS
WHERE (ACTION_SIGN = 'INVOICE_CANCEL');
DELETE FROM ACTIONS
WHERE (ACTION_SIGN = 'INVOICE_STORE');
DELETE FROM ACTIONS
WHERE (ACTION_SIGN = 'ORDERITEM_INVOICE');
DELETE FROM ACTIONS
WHERE (ACTION_SIGN = 'ORDERTAX_INVOICE');

DELETE FROM ACTIONCODES
WHERE (ACTION_SIGN = 'ACCOUNT_USERCREDIT');
DELETE FROM ACTIONCODES
WHERE (ACTION_SIGN = 'ACCOUNT_USERDEBIT');
DELETE FROM ACTIONCODES
WHERE (ACTION_SIGN = 'INVOICE_CANCEL');
DELETE FROM ACTIONCODES
WHERE (ACTION_SIGN = 'INVOICE_STORE');
DELETE FROM ACTIONCODES
WHERE (ACTION_SIGN = 'ORDERITEM_INVOICE');
DELETE FROM ACTIONCODES
WHERE (ACTION_SIGN = 'ORDERTAX_INVOICE');


